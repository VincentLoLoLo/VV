# Skoda 神秘客預約系統

這個專案提供一個靜態的神秘客入口網站，整合登入、預約時段與新成年註冊。所有流程皆以模擬資料運作，方便先在單機環境驗證介面與自動化流程，再導入 n8n 或其他後端服務。

## 介面特色

- **雙重驗證登入** - 須輸入 Email、密碼並通過 6 位數驗證碼
- **品牌儀表板** - 顯示各車廠品牌的任務與可預約時段
- **預約流程** - 選擇品牌與月份後進行預約
- **新成員註冊** - 線上表單蒐集基本資訊
- **即時反饋** - Toast 通知提示操作結果

## 快速開始

### 1. 基本部署

直接上傳 `index.html` 至任意靜態網站服務或本地伺服器即可使用。

### 2. 修改數據

在 `index.html` 中調整以下變量：
- `MOCK_APPROVED_USERS` - 可登入的測試帳號
- `BRAND_DATA` - 品牌資料
- `SEASONAL_LOCATIONS` - 月份別經銷商

### 3. 整合 n8n 後端

將模擬的 `setTimeout` 改為實際 API 呼叫，保持現有 UI 邏輯不變。

## 架構

- `index.html` - 包含所有 HTML、CSS 與 JavaScript
- 模擬數據 - 用於測試與示範
- Tailwind CSS - 用於樣式設計

## 測試帳號

帳號資訊僅供開發測試使用。詳情請聯繫系統管理員。

> **⚠️ 提醒** - 實際導入時請使用後端產生的一次性驗證碼。

---

## Codex 与 GitHub 自動化流程

此专案已設置 GitHub Actions 自動化流程，不需要手動粗理 PR 的合併和删除。

### 工作流程

1. 在 Codex 中修改程式碼
2. 點擊「建立 PR」按鈕
3. GitHub Actions 會自動:
   - 検測以 `codex-` 開頫的 PR
   - 自動合併到 main 分支
   - 自動刪除已合併的分支

### 流程配置檔

- `.github/workflows/auto-merge.yml` - 自動合併流程

> ✅ 你的 PR 會被自動合併！你只需要專注於程式碼的修改。
>
> 
---

# 📚 完整開發指南（非常詳細版）

**給沒有開發背景的你** - 如果你之前從未寫過程式碼，這份指南適合你。

## 🎯 核心概念（重要！）

### 三個環境的概念

把你的網站想像成一個餐廳：

```
生產環境（main） = 真實餐廳，有真正的客人，真實的營業數據
  ↓
測試環境（staging） = 試驗廚房，測試新菜單，用假食材
  ↓
開發環境（codex） = Codex 的工作室，開發新功能，用假數據
```

**最重要的規則**：真實數據永遠只在生產環境（main）！

---

## 📁 你的倉庫文件結構

```
VV/
├── index.html              ← 網頁頁面（UI 框架，沒有真實數據）
├── README.md               ← 這個文件（使用說明）
├── .env.example            ← 環境變數說明（給其他人參考用）
├── .gitignore              ← 告訴 Git 忽略敏感文件
│
├── docs/                   ← 文件說明資料夾
│   ├── WORKFLOW.md         ← 日常工作流程（怎麼改代碼）
│   ├── DATA-PROTECTION.md  ← 數據保護方案（怎麼保護真實數據）
│   └── FAQ.md              ← 常見問題
│
└── .github/workflows/      ← 自動化腳本
    ├── auto-merge.yml      ← 自動合併 PR
    └── delete-branch-on-merge.yml ← 自動刪除已合併分支
```

---

## 🌿 分支說明（非常重要）

你的倉庫有 **3 個主要分支**，每個用途不同：

### 1️⃣ **main 分支**（🔒 生產環境 - 最重要）
- **用途**：線上網站使用（真實客人在用）
- **包含內容**：UI 框架 + 配置文件
- **不包含內容**：真實數據、測試數據
- **誰可以改**：只有經過徹底測試後才合併
- **刪除真實數據規則**：絕對不能刪除或修改真實數據！

### 2️⃣ **staging 分支**（🧪 測試環境 - 可以隨意改）
- **用途**：測試新功能（在上線前測試）
- **包含內容**：新功能代碼 + 假測試數據
- **使用者**：你本人，在本地電腦測試
- **規則**：可以隨意改，不會影響線上網站

### 3️⃣ **codex 分支**（👨‍💻 開發環境 - Codex 工作區）
- **用途**：Codex 開發新功能
- **包含內容**：新功能代碼 + 假數據
- **規則**：Codex 在這裡自由開發，完成後創建 PR
- **何時刪除**：PR 合併到 main 後，GitHub 自動刪除

---

## 🚀 日常操作流程

### ✅ 情境 1：Codex 開發了新功能

**流程**（自動進行，你不用做）：
```
1. Codex 在 codex 分支開發新功能
   ↓
2. Codex 建立 Pull Request（PR）
   ↓
3. 你檢查代碼（看起來沒問題？）
   ↓
4. 你點擊「Merge pull request」合併到 main
   ↓
5. GitHub 自動：
   - 合併代碼到 main
   - 刪除舊的 codex-xxx 分支
   - 部署到線上網站
   ↓
6. 完成！網站自動更新 ✨
```

### 🐛 情境 2：線上網站有 bug（緊急修復）

**流程**：
```
1. 你發現線上網站有問題
   ↓
2. 告訴 Codex：「main 分支有個 bug...」
   ↓
3. Codex 建立一個修復分支（bugfix-xxx）
   ↓
4. Codex 修復完成，建立 PR
   ↓
5. 你檢查修復（沒有影響其他功能？）
   ↓
6. 你合併 PR 到 main
   ↓
7. 網站自動更新，bug 修復 ✓
```

**重要**：修復 bug 時，要確保不要改動真實數據！

### 📋 情境 3：你想看 Codex 開發的進度

**流程**：
```
1. 進入 GitHub 的「Pull requests」頁面
   ↓
2. 看看有沒有開放的 PR（代表 Codex 正在開發）
   ↓
3. 點進 PR 看詳細內容
   ↓
4. 如果 Codex 標記為「Ready to merge」，就可以合併
```

---

## 🔐 如何保護真實數據（最重要！）

### 規則很簡單

```
真實數據 = 只存在於 main 分支的 .env.production 文件中
          或者存在於外部服務（不在 GitHub 上）

其他所有分支 = 只用假數據（mock data）測試
```

### 實際例子

❌ **錯誤**：把真實數據保存在代碼裡
```javascript
const realData = {
  users: [
    { name: "王小明", email: "wang@example.com" },  // ❌ 真實用戶數據！
    { name: "李美美", email: "lee@example.com" }    // ❌ 危險！
  ]
}
```

✅ **正確**：用假數據測試
```javascript
const mockData = {
  users: [
    { name: "測試用戶1", email: "test1@example.com" },  // ✓ 假數據
    { name: "測試用戶2", email: "test2@example.com" }   // ✓ 安全
  ]
}
```

---

## 💡 給 Codex 的指示模板

當你要 Codex 開發新功能時，可以這樣說：

```
親愛的 Codex，

請幫我開發一個新功能：[功能名稱]

需求：
- [需求1]
- [需求2]
- [需求3]

重要提醒：
✓ 使用假數據（mock data）測試
✓ 不要改動真實數據
✓ 在 codex 分支開發
✓ 完成後建立 PR 給我檢查
✓ 確保沒有破壞現有功能

謝謝！
```

---

## ❓ 常見問題

### Q1：我可以直接改 main 分支嗎？
**A**：不行！main 分支有真實數據和真實客人。你的改動會直接影響線上網站。

### Q2：要怎麼測試新功能？
**A**：Codex 應該在 codex 分支開發和測試。如果你也要測試，可以在本地電腦用假數據測試。

### Q3：bug 修復要多久才能上線？
**A**：修復後建立 PR → 你檢查 → 你合併 → 自動部署到線上。通常 5-10 分鐘內網站更新。

### Q4：舊數據會不會被新代碼覆蓋？
**A**：不會！只要你遵循「main = 生產，codex = 測試」的規則，真實數據永遠是安全的。

### Q5：Codex 開發中的分支（如 codex-xxx）會一直存在嗎？
**A**：不會。PR 合併到 main 後，GitHub 會自動刪除 codex-xxx 分支。

---

## 🎓 學習路徑

**如果這是你第一次用 GitHub：**

1. 先理解「分支」的概念（把它想像成不同的工作室）
2. 理解「Pull Request」（合併代碼前的審查步驟）
3. 理解「環境」（開發、測試、生產的區別）
4. 開始用這套系統

---

## 📞 需要幫助？

如果你：
- 不確定該不該合併某個 PR → **點進 PR 看內容，問 Codex「這個安全嗎？」**
- 發現網站壞掉 → **立即告訴 Codex，並說明什麼壞了**
- 想要新功能 → **用上面的「給 Codex 的指示模板」描述需求**
- 擔心數據遺失 → **記住：真實數據在 main 分支的 .env 文件，其他地方都是測試用的**

---

**最後提醒**：

這套系統的目的就是讓你安心。
- 你不用擔心 bug 會永久刪除數據
- 你不用擔心新功能會破壞現有功能
- 你不用擔心真實客人的數據會被誤刪

只要記住一個原則：**真實數據只在 main 分支，其他地方都能隨意改**。

祝你開發順利！🎉

**上次部署** 2025-11-15 (GitHub Pages)

---

## ✅ 已完成的系統設置步驟

### 第一階段：架構設計（已完成）
- ✅ 設計三環境系統架構（Production / Staging / Development）
- ✅ 定義分支規則和數據保護策略
- ✅ 編寫完整中文開發指南（500+ 行）

### 第二階段：安全保護配置（已完成）
- ✅ 創建 `.gitignore` 文件
  - 保護所有 `.env` 文件
  - 忽略敏感配置和系統文件
- ✅ 創建 `.env.example` 模板
  - 展示所有必需的環境變數
  - 標記生產、測試、開發環境配置
  - 包含 n8n 整合配置示例

### 第三階段：合併衝突解決（進行中）
- ✅ 解決 README.md 合併衝突
  - 保留主分支的完整開發指南
- ⏳ 解決 index.html 34 個合併衝突
  - **建議方案**：由 Codex 使用命令行解決
  - 原因：Web 編輯器不適合大量衝突

---

## 🚀 未來計劃

### 立即行動（本週內）
1. **合併 PR #8**
   - Codex 使用 git 命令解決 index.html 衝突
   - 自動合併新的管理儀表板功能
   - GitHub Actions 自動部署

2. **創建配置文檔**
   - `docs/WORKFLOW.md` - 詳細工作流程
   - `docs/DATA-PROTECTION.md` - 數據保護深度指南
   - `docs/FAQ.md` - 常見問題擴展版

### 短期計劃（1-2 週）
3. **測試驗證**
   - 驗證三環境完全分離
   - 測試 Codex 在 codex 分支開發
   - 測試新功能 PR 流程
   - 測試緊急修復流程

4. **監控和日誌**
   - 設置部署監控
   - 記錄所有分支變動
   - 追蹤 GitHub Actions 自動化

### 中期計劃（1 個月）
5. **團隊培訓**
   - 培訓 Codex 使用新工作流程
   - 確保理解數據保護的重要性
   - 建立代碼審查流程

6. **性能優化**
   - 優化自動化流程
   - 減少手動操作步驟
   - 加快部署時間

---

## 📋 系統現狀總結

| 組件 | 狀態 | 說明 |
|------|------|------|
| 架構設計 | ✅ 完成 | 三環境系統已規劃和文檔化 |
| 數據保護 | ✅ 完成 | .gitignore 和 .env.example 已配置 |
| README 指南 | ✅ 完成 | 500+ 行中文完整指南已撰寫 |
| README 合併衝突 | ✅ 解決 | 已接受 main 分支版本 |
| PR #8 合併 | ⏳ 進行中 | 等待解決 index.html 34 個衝突 |
| 測試流程 | ⏳ 待開始 | 將在 PR #8 合併後進行 |

---

## 💡 給 Codex 的下一步指示

```
親愛的 Codex,

請執行以下步驟來完成系統設置：

1. 在本地解決 PR #8 的 index.html 衝突
   使用命令：git checkout --theirs index.html
   
2. 完成合併並推送
   git commit -m "Resolve merge conflicts"
   git push origin codex-bg85un
   
3. PR #8 將自動合併到 main 分支

4. GitHub Actions 將自動部署新版本

感謝！
```

---

## 📞 重要提示

### 數據安全
- ⚠️ 真實客戶數據只存儲在 `.env.production`
- ⚠️ 開發和測試只使用假數據
- ⚠️ `.env` 文件永遠不會被提交到 GitHub

### 分支規則
- 🔒 `main` 分支 = 生產環境（只含生產配置）
- 🧪 `staging` 分支 = 測試環境（只含測試數據）
- 👨‍💻 `codex` 分支 = 開發環境（Codex 工作區）

### 聯繫方式
如有任何問題或困惑，請隨時溝通。此系統的目的是保護數據和簡化工作流程！

---

**最後更新**：2025-11-15（已完成初期設置）
